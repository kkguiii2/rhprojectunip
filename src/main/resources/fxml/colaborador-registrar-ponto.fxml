<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<BorderPane xmlns="http://javafx.com/javafx/11.0.1" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.shiftly.controller.RegistrarPontoController">
   <top>
      <VBox alignment="TOP_CENTER" spacing="20.0" styleClass="header-container">
         <padding>
            <Insets bottom="20.0" left="30.0" right="30.0" top="30.0" />
         </padding>
         <children>
            <HBox alignment="CENTER_LEFT" spacing="20.0">
               <children>
                  <Button fx:id="voltarButton" onAction="#handleVoltar" styleClass="button-secondary" text="← Voltar" />
                  <Region HBox.hgrow="ALWAYS" />
                  <Label styleClass="page-title" text="Registrar Ponto" />
                  <Region HBox.hgrow="ALWAYS" />
                  <Label fx:id="dataHoraLabel" styleClass="date-time-label" text="01/09/2024 - 14:30" />
               </children>
            </HBox>
         </children>
      </VBox>
   </top>
   
   <center>
      <ScrollPane fitToHeight="true" fitToWidth="true" hbarPolicy="NEVER" vbarPolicy="AS_NEEDED">
         <content>
            <VBox alignment="TOP_CENTER" spacing="30.0" styleClass="main-content">
               <padding>
                  <Insets bottom="30.0" left="30.0" right="30.0" top="20.0" />
               </padding>
               <children>
                  <!-- Status do Sistema -->
                  <VBox alignment="CENTER" spacing="15.0" styleClass="status-container">
                     <children>
                        <HBox alignment="CENTER" spacing="10.0">
                           <children>
                              <Label fx:id="statusLabel" styleClass="status-label" text="Sistema Online" />
                              <Region prefWidth="10.0" />
                              <ProgressIndicator fx:id="statusIndicator" prefHeight="20.0" prefWidth="20.0" progress="1.0" styleClass="status-indicator" />
                           </children>
                        </HBox>
                        <Label fx:id="localizacaoLabel" styleClass="location-label" text="📍 Aguardando localização..." />
                     </children>
                  </VBox>

                  <!-- Tipo de Ponto -->
                  <VBox alignment="CENTER" spacing="20.0" styleClass="card">
                     <padding>
                        <Insets bottom="30.0" left="30.0" right="30.0" top="30.0" />
                     </padding>
                     <children>
                        <Label styleClass="section-title" text="Tipo de Ponto" />
                        <HBox alignment="CENTER" spacing="30.0">
                           <children>
                              <ToggleButton fx:id="entradaButton" onAction="#handleTipoSelecionado" prefHeight="100.0" prefWidth="150.0" styleClass="toggle-button-large" text="🕐&#10;ENTRADA" />
                              <ToggleButton fx:id="saidaButton" onAction="#handleTipoSelecionado" prefHeight="100.0" prefWidth="150.0" styleClass="toggle-button-large" text="🕕&#10;SAÍDA" />
                           </children>
                        </HBox>
                     </children>
                  </VBox>

                  <!-- Reconhecimento Facial -->
                  <VBox alignment="CENTER" spacing="20.0" styleClass="card">
                     <padding>
                        <Insets bottom="30.0" left="30.0" right="30.0" top="30.0" />
                     </padding>
                     <children>
                        <Label styleClass="section-title" text="Reconhecimento Facial" />
                        <HBox alignment="CENTER" spacing="20.0">
                           <children>
                              <VBox alignment="CENTER" spacing="10.0">
                                 <children>
                                    <Label fx:id="cameraStatus" styleClass="camera-status" text="📷 Câmera Inativa" />
                                    <Rectangle fx:id="cameraPreview" arcHeight="10.0" arcWidth="10.0" fill="#f0f0f0" height="200.0" stroke="BLACK" strokeType="INSIDE" strokeWidth="2.0" width="250.0" />
                                    <Button fx:id="ativarCameraButton" onAction="#handleAtivarCamera" styleClass="button-primary" text="Ativar Câmera" />
                                 </children>
                              </VBox>
                              <VBox alignment="CENTER" spacing="15.0">
                                 <children>
                                    <Label styleClass="face-status" text="Status da Validação:" />
                                    <Label fx:id="faceValidationStatus" styleClass="face-validation-status" text="🔴 Aguardando" />
                                    <ProgressBar fx:id="faceProgressBar" prefWidth="200.0" progress="0.0" styleClass="face-progress" />
                                    <Label fx:id="faceConfidenceLabel" styleClass="face-confidence" text="Confiança: 0%" />
                                 </children>
                              </VBox>
                           </children>
                        </HBox>
                     </children>
                  </VBox>

                  <!-- Geolocalização -->
                  <VBox alignment="CENTER" spacing="20.0" styleClass="card">
                     <padding>
                        <Insets bottom="30.0" left="30.0" right="30.0" top="30.0" />
                     </padding>
                     <children>
                        <Label styleClass="section-title" text="Localização" />
                        <HBox alignment="CENTER" spacing="30.0">
                           <children>
                              <VBox alignment="CENTER_LEFT" spacing="10.0">
                                 <children>
                                    <Label text="📍 Coordenadas:" />
                                    <Label fx:id="coordenadasLabel" styleClass="coordinates-label" text="Lat: -, Long: -" />
                                    <Label text="📍 Precisão:" />
                                    <Label fx:id="precisaoLabel" styleClass="precision-label" text="- metros" />
                                    <Label text="🏢 Endereço:" />
                                    <Label fx:id="enderecoLabel" styleClass="address-label" text="Aguardando localização..." wrapText="true" />
                                 </children>
                              </VBox>
                              <VBox alignment="CENTER" spacing="10.0">
                                 <children>
                                    <Button fx:id="obterLocalizacaoButton" onAction="#handleObterLocalizacao" styleClass="button-secondary" text="🔄 Atualizar Localização" />
                                    <Label fx:id="distanciaLabel" styleClass="distance-label" text="🎯 Distância: Calculando..." />
                                    <Label fx:id="validacaoLocalLabel" styleClass="location-validation" text="✅ Local Válido" />
                                 </children>
                              </VBox>
                           </children>
                        </HBox>
                     </children>
                  </VBox>

                  <!-- Observações -->
                  <VBox alignment="CENTER" spacing="15.0" styleClass="card">
                     <padding>
                        <Insets bottom="30.0" left="30.0" right="30.0" top="30.0" />
                     </padding>
                     <children>
                        <Label styleClass="section-title" text="Observações (Opcional)" />
                        <TextArea fx:id="observacoesTextArea" maxHeight="80.0" prefColumnCount="50" prefRowCount="3" promptText="Digite observações sobre este registro de ponto..." styleClass="text-area" wrapText="true" />
                     </children>
                  </VBox>

                  <!-- Ações -->
                  <HBox alignment="CENTER" spacing="30.0">
                     <children>
                        <Button fx:id="cancelarButton" onAction="#handleCancelar" prefHeight="50.0" prefWidth="150.0" styleClass="button-danger" text="Cancelar" />
                        <Button fx:id="registrarPontoButton" disable="true" onAction="#handleRegistrarPonto" prefHeight="50.0" prefWidth="200.0" styleClass="button-success" text="📍 REGISTRAR PONTO" />
                     </children>
                  </HBox>

                  <!-- Status do Registro -->
                  <VBox fx:id="statusRegistroContainer" alignment="CENTER" spacing="10.0" styleClass="status-registro" visible="false">
                     <children>
                        <ProgressIndicator fx:id="registroProgressIndicator" prefHeight="30.0" prefWidth="30.0" />
                        <Label fx:id="statusRegistroLabel" styleClass="status-registro-label" text="Processando registro..." />
                     </children>
                  </VBox>
               </children>
            </VBox>
         </content>
      </ScrollPane>
   </center>
</BorderPane>
